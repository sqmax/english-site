<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Servlet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="sunqiang">

    <!-- Le styles -->
    <link rel="stylesheet" href="http://www.sqmax.top/english-site/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="http://www.sqmax.top/english-site/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="http://www.sqmax.top/english-site/theme/css/font-awesome.css" rel="stylesheet">

    <link href="http://www.sqmax.top/english-site/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://www.sqmax.top/english-site/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="http://www.sqmax.top/english-site/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://www.sqmax.top/english-site/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://www.sqmax.top/english-site/theme/images/apple-touch-icon-114x114.png">

    <link href="http://www.sqmax.top/english-site/" type="application/atom+xml" rel="alternate" title="SqMax ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://www.sqmax.top/english-site/index.html">SqMax </a>
          <div class="nav-collapse">
            <ul class="nav">
                <li><a href="http://www.sqmax.top/english-site/pages/about-me.html">About Me</a></li>
                          <li class="divider-vertical"></li>
                  <li class="active">
                    <a href="http://www.sqmax.top/english-site/category/review.html">
						<i class="icon-folder-open icon-large"></i>Review
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="http://www.sqmax.top/english-site/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Servlet">
                                        Servlet
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2018-06-07T00:00:00+08:00">
        <i class="icon-calendar"></i>四 07 六月 2018
</abbr>
<span class="label">By</span>
<a href="http://www.sqmax.top/english-site/author/sunqiang.html"><i class="icon-user"></i>sunqiang</a>
<span class="label">Category</span>
<a href="http://www.sqmax.top/english-site/category/review.html"><i class="icon-folder-open"></i>Review</a>.


</footer><!-- /.post-info -->                </div>
                <p>Servlet通常被称为服务器端小程序，是运行在服务器端的程序，用于处理及响应客服端的请求。自MVC规范出现后，Servlet的责任开始明确下来，仅仅作为控制器使用。</p>
<h2>Servlet定义</h2>
<p>Servlet是个特殊的Java类，这个Java类必须继承HttpServlet。Servlet通常被称为服务器端小程序，是运行在服务器端的程序，用于处理及响应客服端的请求。自MVC规范出现后，Servlet的责任开始明确下来，仅仅作为控制器使用。Servlet与客户端通过Servlet容器进行交互,Servlet提供不同的方法用于响应客户端请求。</p>
<ul>
<li>doGet:用于响应客户端的GET请求。</li>
<li>doPost:用于响应客户端的POST请求。</li>
<li>doPut:用于响应客户端的PUT请求。</li>
<li>doDelete:用于响应客户端的DELETE请求。</li>
</ul>
<p>事实上，客户端的请求通常只有GET和POST两种，Servlet为了响应这两种请求，必须重写doGet和doPost方法。大部分时候，Servlet对于所有请求的响应都是一样的，只需重写一个方法来代替上面的几个方法：只需重写service()方法即可响应客户端的所有请求。
Servlet在服务器端充当的角色如下图
<img alt="" src="http://wx4.sinaimg.cn/large/0072Njp2ly1focq1a96ikj30iz06gmzf.jpg"> </br>
附：<a href="http://tomcat.apache.org/tomcat-8.5-doc/servletapi/index.html">Servlet API文档</a></p>
<h2>Servlet的调用过程和生命周期</h2>
<p><img alt="" src="http://wx4.sinaimg.cn/large/0072Njp2ly1focr862r7kj30eg0b975m.jpg">
Servlet的生命周期可以归纳为一下几步：</p>
<ol>
<li>装载Servlet，这一项操作一般是动态执行的。然而，Servlet通常会提供一个管理的选项，用于在Servlet启动时强制装载和初始化特定的Servlet。</li>
<li>Server创建一个Servlet实例。</li>
<li>Server调用Servlet的init()方法。</li>
<li>一个客户端请求到达Server。</li>
<li>Server创建一个请求对象。</li>
<li>Server创建一个响应对象。</li>
<li>Server激活Servlet的service()方法，传递请求和响应对象作为参数。</li>
<li>service()方法获得关于请求对象的信息，处理请求，访问其他资源，获得需要的信息。</li>
<li>service()方法使用响应对象的方法,将响应传回Server，最终到达客户端。service()方法可能激活其他方法以处理请求。如doGet，doPost或其他程序员自己开发的方法。</li>
<li>对于更多的客户端请求，Server创建新的请求和响应对象，仍然激活此Servlet的service()方法，将这两个对象作为参数传递给它，如此重复以上的循环，但无需再次调用init()方法，Servlet一般只初始化一次。</li>
<li>当Server不再需要Servlet时，比如当Server要关闭时，Server调用Servlet的destroy()。</li>
</ol>
<h2>开发并配置一个简单的Servlet</h2>
<p>将编译好的Servlet class文件放到web应用的WEB-INF/classes路径下，然后为了让Servlet能够响应用户请求，还必须将Servlet配置在web应用中。配置Servlet时，需要修改web.xml文件。不过从Servlet3.0开始，新增了注解的方式配置Servlet,只需Servlet类上用@WebServlet注解即可配置一个Servlet。
下面通过注解配置一个简单的Servlet。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.PrintWriter</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.annotation.WebServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author root</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;firstServlet&quot;</span><span class="o">,</span> <span class="n">urlPatterns</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&quot;/firstServlet&quot;</span> <span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FirstServlet</span> <span class="kd">extends</span> <span class="n">HttpServlet</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">service</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">&quot;text/html;charSet=UTF-8&quot;</span><span class="o">);</span>
        <span class="n">PrintWriter</span> <span class="n">pw</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
        <span class="n">pw</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Hello Servlet!&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>其对应的web.xml配置如下</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;servlet&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>firstServlet<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;servlet-class&gt;</span>FirstServlet<span class="nt">&lt;/servlet-class&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
<span class="nt">&lt;servlet-mapping&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>firstServlet<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/firstServlt<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;servlet-mapping&gt;</span>
</pre></div>


<h2>load-on-startup Servlet</h2>
<p>创建Servlet实例有两个时机：用户请求之时或应用启动之时，应用启动时就创建的Servlet，通常适用于某些后台服务的Servlet，或者需要拦截很多请求的Servlet，这种Servlet通常作为应用的基础Servlet使用，提供重要的后台服务。
配置load-on-startup的Servlet有两种方式。</p>
<ul>
<li>在web.xml中通过<code>&lt;servlet&gt;</code>元素的<code>&lt;load-on-startup&gt;</code>子元素进行配置。</li>
<li>通过@WebServlet注解的loadOnStartup属性指定。</li>
</ul>
<p>其中<code>&lt;load-on-startup&gt;</code>元素或loadOnStartup属性都接受一个整型值，越小，Servlet越优先实例化。</p>
<h2>参考</h2>
<ul>
<li><a href="http://blog.csdn.net/evankaka/article/details/45151569">Servlet入门总结及第一个Servlet程序</a></li>
<li><a href="http://blog.csdn.net/evankaka/article/details/46673051">Servlet和Jsp生命周期解读</a></li>
</ul>
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="http://getpelican.com/"><i class="icon-external-link"></i>Pelican</a></li>
    <li><a href="http://python.org/"><i class="icon-external-link"></i>Python.org</a></li>
    <li><a href="http://jinja.pocoo.org/"><i class="icon-external-link"></i>Jinja2</a></li>
    <li><a href="https://imooc.com"><i class="icon-external-link"></i>慕课网</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
    <li><a href="http://www.sqmax.top"><i class="icon-知乎-sign icon-large"></i>知乎</a></li>
    <li><a href="http://weibo.com"><i class="icon-微博-sign icon-large"></i>微博</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="http://www.sqmax.top/english-site/category/review.html">
    <i class="icon-folder-open icon-large"></i>Review
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://www.sqmax.top/english-site/theme/js/jquery-1.7.2.min.js"></script>
    <script src="http://www.sqmax.top/english-site/theme/js/bootstrap.min.js"></script>
  </body>
</html>