<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Tomcat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="sunqiang">

    <!-- Le styles -->
    <link rel="stylesheet" href="https://github.com/sqmax/english-site/tree/gh-pages/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="https://github.com/sqmax/english-site/tree/gh-pages/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="https://github.com/sqmax/english-site/tree/gh-pages/theme/css/font-awesome.css" rel="stylesheet">

    <link href="https://github.com/sqmax/english-site/tree/gh-pages/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="https://github.com/sqmax/english-site/tree/gh-pages/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://github.com/sqmax/english-site/tree/gh-pages/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://github.com/sqmax/english-site/tree/gh-pages/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://github.com/sqmax/english-site/tree/gh-pages/theme/images/apple-touch-icon-114x114.png">

    <link href="https://github.com/sqmax/english-site/tree/gh-pages/" type="application/atom+xml" rel="alternate" title="SqMax ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="https://github.com/sqmax/english-site/tree/gh-pages/index.html">SqMax </a>
          <div class="nav-collapse">
            <ul class="nav">
                <li><a href="https://github.com/sqmax/english-site/tree/gh-pages/pages/about-me.html">About Me</a></li>
                          <li class="divider-vertical"></li>
                  <li class="active">
                    <a href="https://github.com/sqmax/english-site/tree/gh-pages/category/review.html">
						<i class="icon-folder-open icon-large"></i>Review
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="https://github.com/sqmax/english-site/tree/gh-pages/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Tomcat">
                                        Tomcat
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2018-06-06T00:00:00+08:00">
        <i class="icon-calendar"></i>三 06 六月 2018
</abbr>
<span class="label">By</span>
<a href="https://github.com/sqmax/english-site/tree/gh-pages/author/sunqiang.html"><i class="icon-user"></i>sunqiang</a>
<span class="label">Category</span>
<a href="https://github.com/sqmax/english-site/tree/gh-pages/category/review.html"><i class="icon-folder-open"></i>Review</a>.


</footer><!-- /.post-info -->                </div>
                <h2>tomcat服务器</h2>
<p>Tomcat下载地址：<a href="http://tomcat.apache.org">http://tomcat.apache.org</a>，解压即可。解压缩后有如下的文件结构。</p>
<ul>
<li>bin:存放启动和关闭Tomcat的命令的路径</li>
<li>conf：存放Tomcat的配置，所有Tomcat的配置都在改路径下设置。</li>
<li>lib:存放Tomcat服务器的核心类库（JAR文件），如果要扩展Tomcat的功能，也可将第三方类库复制到改路径下。</li>
<li>logs:保存Tomcat每次运行后产生的日志。</li>
<li>temp: 保存运行过程中生成的临时文件。</li>
<li>webapps: 该路径用于自动部署Web应用，将Web应用复制到该路径下，Tomcat会将该应用制动部署在容器中。</li>
<li>work:保存Web应用在运行过程中，编译生成的class文件。该文件夹可以删除，但每次启动Tomcat服务器是，系统将再次建立该路径。</li>
<li>LIcense等相关文档。</li>
</ul>
<p>启动Tomcat服务器：双击Tomcat安装路径下的bin目录中的starup.bat文件即可。</p>
<h2>一个完整Web应用的结构</h2>
<div class="highlight"><pre><span></span>mail---------------------------Web应用所在目录
   |----html、jsp、css、js等文件，根目录下的文件外界可以直接访问
   |----WEB-INF目录
            |---------classes目录(java类)
            |---------lib目录(java类运行所需的jar包)
            |---------web.xml(web应用的配置文件)
     WEB-INF 这个目录下的文件外界无法直接访问，由web服务器负责调用
</pre></div>


<h2>手动部署Web应用</h2>
<p>在Tomcat中部署Web应用的方式主要有以下几种。</p>
<ul>
<li>利用Tomcat的自动部署。
该方式是最简单的，只要将一个Web应用复制到Tomcat的webapps下，系统就会把该应用部署到Tomcat中。</li>
<li>利用控制台部署Web应用。
在使用该方式之前，需要在conf目录的tomcat-users.xml中，添加一个用户如下：
<code>&lt;user username="manager" password="manager" roles="manager-gui"/&gt;</code>
然后启动tomcat容器，进入控制台，点击'''Manager App'''来部署web应用。
<img alt="" src="http://wx3.sinaimg.cn/large/0072Njp2ly1foaj92qnhbj30qb05h0ta.jpg">
部署之后，会发现Tomcat的webapps目录下多了一个文件夹，该文件夹的内容和webDemo文件夹的内容完全相同。其实该方式和方式一一样，懂事利用Tomcat自动部署。</li>
<li>无需将Web应用复制到Tomcat安装路径下。首先在conf目录下新建Catalina/localhost两层目录路径，在该目录下新建一个任意名字的xml文件例如sq.xml，内容如下：
<code>&lt;Context docBase="G:/webDemo" debug="0" privileged="true"&gt;&lt;/Context&gt;</code>
这样就把我的G盘下的webDemo这个web应用部署在Tomcat容器中了，而不用把该web应用放在Tomcat安装目录的webapps目录下。
该应用的URL地址为：http://localhost:8080/sq</li>
</ul>
<h2>Tomcat的体系结构</h2>
<p><img alt="" src="http://wx1.sinaimg.cn/large/0072Njp2ly1foaj935f0fj30ln0dvmyv.jpg"></p>
<ul>
<li>Server：代表整个Tomcat，它包含所有的容器。</li>
<li>Service：相当于一个集合，包含多个Connector（连接）、一个Engine（引擎），它还负责处理所有Connector（连接）获取的客户请求。</li>
<li>Connector：一个Connector（连接）在指定的接口上侦听客户的请求，并将客户的请求交给Engine（引擎）来进行处理并获得回应返回给客户请求。</li>
<li>Engine：一个Engine（引擎）下可以配置多个虚拟主机Host，每个主机都有一个域名，当Engine获得一个请求时，会把这个请求发送的相应的Host上，Engine有一个默认的虚拟主机，如果没有虚拟主机能够匹配这个请求，那就由这个默认的虚拟主机来进行处理请求。</li>
<li>Host：代表一个Virtual host，每个虚拟主机都和某个网络域名想匹配，每个虚拟主机下面可以部署一个或者多个web app，每个web对应一个context，有一个context path，当一个host获取请求时，就把该请求匹配到某个context上。</li>
<li>Context：一个context对应一个web aplication，一个web由一个或多个servlet组成，Context在创建的时候将根据配置文件CATALINA_HOME/conf/web.xml和WEBAPP_HOME/WEB-INF/web.xml载入servlet类，当context获取请求时，讲在自己的映射表中需找相匹配的servlet类，如果找到，则执行该类，获得请求的回应，并返回。</li>
</ul>
<h2>请求处理过程</h2>
<p>Tomcat处理一个Http请求过程如下，假如有一个来自浏览器的请求：http://localhost:8080/webDemo/index</p>
<ol>
<li>服务器8080端口接收到客户发来的请求，被一个在那里监听的叫HTTP1.1的 Connector获取了这个链接请求。</li>
<li>Connector把请求交给同在Service下的Engine去处理，并等待Engine的响应。</li>
<li>Engine把url解析，并把请求传给相对应的Host处理，如果没有相对应的Host，则用默认名叫localhost的Host来处理。</li>
<li>Host再把url解析为/webDemo/index.html，匹配context-path为/webDemoway的Context去处理（如果匹配不到就把该请求交给路径名为””的Context去处理）。</li>
<li>context-path为/webDemo的Context会匹配Servlet Mapping为/index的Servlet处理；</li>
<li>构造HttpServletRequest对象和HttpServletResponse对象，作为参数调用Servlet的doGet或doPost方法；</li>
<li>Context把处理完的HttpServletResponse对象返回给Host；</li>
<li>Host把HttpServletResponse对象返回给Engine；</li>
<li>Engine把HttpServletResponse对象返回给Connector；</li>
<li>Connector把HttpServletResponse对象返回给客户browser。</li>
</ol>
<h2>参考</h2>
<ul>
<li><a href="http://www.cnblogs.com/rocomp/p/4802396.html">Tomcat安装配置，配置，优化及负载均衡详解</a></li>
<li><a href="https://www.oschina.net/question/12_52027">初学 Java Web 开发，请远离各种框架，从 Servlet 开发</a></li>
<li><a href="http://objcoding.com/2017/06/12/Tomcat-structure-and-processing-request-process/">http://objcoding.com/2017/06/12/Tomcat-structure-and-processing-request-process/</a></li>
<li><a href="https://brianway.github.io/2016/02/06/javaweb-note-1-Tomcat/">https://brianway.github.io/2016/02/06/javaweb-note-1-Tomcat/</a></li>
</ul>
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="http://getpelican.com/"><i class="icon-external-link"></i>Pelican</a></li>
    <li><a href="http://python.org/"><i class="icon-external-link"></i>Python.org</a></li>
    <li><a href="http://jinja.pocoo.org/"><i class="icon-external-link"></i>Jinja2</a></li>
    <li><a href="https://imooc.com"><i class="icon-external-link"></i>慕课网</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
    <li><a href="http://www.sqmax.top"><i class="icon-知乎-sign icon-large"></i>知乎</a></li>
    <li><a href="http://weibo.com"><i class="icon-微博-sign icon-large"></i>微博</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="https://github.com/sqmax/english-site/tree/gh-pages/category/review.html">
    <i class="icon-folder-open icon-large"></i>Review
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://github.com/sqmax/english-site/tree/gh-pages/theme/js/jquery-1.7.2.min.js"></script>
    <script src="https://github.com/sqmax/english-site/tree/gh-pages/theme/js/bootstrap.min.js"></script>
  </body>
</html>